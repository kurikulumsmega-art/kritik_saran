<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sahabat Belajar - SMK Negeri 1 Purbalingga</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4A90E2;
            --secondary-color: #50E3C2;
            --accent-color: #F5A623;
            --text-color: #333;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--bg-color); color: var(--text-color); line-height: 1.6; }
        .container { max-width: 900px; margin: 0 auto; padding: 20px; }
        .hero { background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); color: white; padding: 60px 20px; text-align: center; border-radius: 0 0 30px 30px; }
        .hero h1 { font-size: 2.5rem; font-weight: 700; margin-bottom: 10px; }
        .hero p { font-size: 1.1rem; max-width: 600px; margin: 0 auto; }
        main { padding: 40px 0; }
        .section-title { text-align: center; font-size: 1.8rem; font-weight: 600; margin-bottom: 40px; color: var(--primary-color); }
        .about-card { background: var(--card-bg); padding: 30px; border-radius: 15px; box-shadow: var(--shadow); text-align: center; margin-bottom: 40px; }
        .about-card .icon { font-size: 3rem; color: var(--accent-color); margin-bottom: 15px; }
        .categories-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .category-card { background: var(--card-bg); padding: 30px 20px; border-radius: 15px; box-shadow: var(--shadow); text-align: center; cursor: pointer; transition: transform 0.3s ease, box-shadow 0.3s ease; border: 2px solid transparent; }
        .category-card:hover { transform: translateY(-10px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12); border-color: var(--primary-color); }
        .category-card .icon { font-size: 2.5rem; margin-bottom: 15px; }
        .category-card h3 { font-size: 1.1rem; font-weight: 600; }
        .form-container { background: var(--card-bg); padding: 40px; border-radius: 15px; box-shadow: var(--shadow); display: none; }
        .form-container.active { display: block; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 8px; }
        .form-group textarea { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #ddd; font-family: 'Poppins', sans-serif; font-size: 1rem; resize: vertical; min-height: 120px; }
        .char-counter { text-align: right; font-size: 0.9rem; color: #777; }
        .submit-btn { background: linear-gradient(135deg, var(--accent-color), #f7b733); color: white; border: none; padding: 15px 40px; font-size: 1.1rem; font-weight: 600; border-radius: 50px; cursor: pointer; transition: transform 0.3s ease, box-shadow 0.3s ease; display: block; margin: 20px auto 0; }
        .submit-btn:hover { transform: scale(1.05); box-shadow: 0 5px 15px rgba(245, 166, 35, 0.4); }
        .submit-btn:disabled { background: #ccc; cursor: not-allowed; transform: none; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5); animation: fadeIn 0.3s; }
        .modal-content { background-color: var(--card-bg); margin: 15% auto; padding: 30px; border-radius: 15px; width: 80%; max-width: 500px; text-align: center; animation: slideIn 0.4s; }
        .modal-content h2 { color: var(--primary-color); margin-bottom: 15px; }
        .modal-content p { margin-bottom: 25px; }
        .modal-btn { background: var(--primary-color); color: white; border: none; padding: 10px 25px; border-radius: 25px; cursor: pointer; font-weight: 600; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideIn { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        footer { text-align: center; padding: 20px; background: #333; color: white; margin-top: 40px; }
    </style>
</head>
<body>

    <header class="hero">
        <div class="container">
            <h1>Sahabat Belajar</h1>
            <p>Platform untuk berbagi ide, saran, dan umpan balik membangun demi kemajuan SMK Negeri 1 Purbalingga. Suaramu sangat berarti bagi kami!</p>
        </div>
    </header>

    <main class="container">
        <section id="about" class="about-card">
            <div class="icon">ü§ù</div>
            <h2>Mengapa Berbagi di Sini?</h2>
            <p><b>"Sahabat Belajar" </b>adalah ruang aman untuk menyuarakan pemikiran konstruktifmu. Setiap masukan tentang pelayanan, fasilitas, program, atau budaya positif sekolah akan membantu kita semua tumbuh lebih baik. <strong>Identitasmu 100% rahasia.</strong></p>
        </section>

        <section id="categories">
            <h2 class="section-title">Apa yang ingin kamu bagikan hari ini?</h2>
            <div class="categories-grid">
                <div class="category-card" data-category="pelayanan">
                    <div class="icon">üìö</div>
                    <h3>Pelayanan Belajar</h3>
                </div>
                <div class="category-card" data-category="fasilitas">
                    <div class="icon">üè´</div>
                    <h3>Sarana &amp; Prasarana</h3>
                </div>
                <div class="category-card" data-category="program">
                    <div class="icon">üöÄ</div>
                    <h3>Program Kegiatan</h3>
                </div>
                <div class="category-card" data-category="budaya">
                    <div class="icon">üíñ</div>
                    <h3>Budaya Positif Sekolah</h3>
                </div>
            </div>
        </section>

        <section id="form-section" class="form-container">
            <h2 class="section-title">Tuliskan Umpan Balikmu</h2>
            <form id="feedback-form">
                <input type="hidden" id="category-input">
                <div class="form-group">
                    <label for="feedback-text">Pesanmu (saran, ide, atau apresiasi)</label>
                    <textarea id="feedback-text" placeholder="Contoh: Semoga lab komputer bisa ditambah software desain grafis baru, agar siswa lebih siap terjun ke dunia industri..." maxlength="500" required></textarea>
                    <div class="char-counter"><span id="char-count">0</span> / 500</div>
                </div>
                <button type="submit" class="submit-btn">Kirim Umpan Balik</button>
            </form>
        </section>
    </main>

    <footer>
        <p>¬© 2025 SMK Negeri 1 Purbalingga. Dibuat dengan ‚ù§Ô∏è untuk kemajuan bersama.</p>
    </footer>

    <!-- Modal Confirmation -->
    <div id="confirmationModal" class="modal">
        <div class="modal-content">
            <h2>Terima Kasih! üéâ</h2>
            <p>Umpan balikmu sangat berharga. Kami akan menindaklanjutinya untuk menjadikan sekolah kita lebih baik lagi.</p>
            <button class="modal-btn" onclick="closeModal()">Tutup</button>
        </div>
    </div>

    <!-- PERHATIKAN BAGIAN INI: URL GOOGLE SCRIPT SUDAH TERBARU -->
    <script>
        const categoryCards = document.querySelectorAll('.category-card');
        const formContainer = document.getElementById('form-section');
        const categoryInput = document.getElementById('category-input');
        const feedbackForm = document.getElementById('feedback-form');
        const feedbackText = document.getElementById('feedback-text');
        const charCount = document.getElementById('char-count');
        const modal = document.getElementById('confirmationModal');
        const submitBtn = document.querySelector('.submit-btn');

        // --- URL GOOGLE APPS SCRIPT ANDA YANG PALING BARU ---
        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzGkaqifTnk2QqDDMKfiT4Af2YO-pUub9PBpaCL55wUuRtFDLhyEIptg9gAgWv97XCDVw/exec";

        categoryCards.forEach(card => {
            card.addEventListener('click', () => {
                categoryInput.value = card.dataset.category;
                formContainer.classList.add('active');
                formContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
            });
        });

        feedbackText.addEventListener('input', () => {
            charCount.textContent = feedbackText.value.length;
        });

        feedbackForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const category = categoryInput.value;
            const message = feedbackText.value;

            if (!category || !message) {
                alert('Harap pilih kategori dan tulis pesan Anda.');
                return;
            }

            submitBtn.disabled = true;
            submitBtn.textContent = 'Mengirim...';

            const data = { kategori: category, pesan: message };

            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                if (result.status === 'success') {
                    showModal();
                    feedbackForm.reset();
                    charCount.textContent = '0';
                    formContainer.classList.remove('active');
                } else {
                    throw new Error(result.message || 'Server mengembalikan error.');
                }

            } catch (error) {
                console.error('Error:', error);
                alert('Terjadi kesalahan: ' + error.message + '. Silakan coba lagi.');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Kirim Umpan Balik';
            }
        });

        function showModal() { modal.style.display = 'block'; }
        function closeModal() { modal.style.display = 'none'; }
        window.onclick = function(event) { if (event.target == modal) { closeModal(); } }
    </script>
</body>
</html>